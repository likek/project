{"version":3,"sources":["../../../../assets/script/assets/script/ProgressJs.js"],"names":["showType","blockWidth","miWidth","speed","cc","Class","extends","Component","properties","starPre","Prefab","starPNode","Node","rightSF","SpriteFrame","errSF","initSF","blueStar","flayNode","rigthAction","onLoad","starData","starFlagAction","init","numCount","i","instantiate","parent","node","position","p","thi","push","startPos","getStarPosByIndex","showStarFlag","setStarTypeByIndex","index","type","hideStarFlag","toString","scheduleOnce","getComponent","Sprite","spriteFrame","opacity","scaleX","scaleY","active","Animation","play","callFunc","target","runAction","sequence","spawn","scaleTo","fadeTo","length","pos","rotateTo","zIndex","actionNode","getChildByName","repeatForever","playFlayStar","flagIndex","callback","object","lizi","ParticleSystem","resetSystem","call","distance","pDistance","time","Math","min","moveTo"],"mappings":"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","file":"ProgressJs.js","sourceRoot":"../../../../assets/script","sourcesContent":["//星星2种纹理\nlet showType = {\n    \"1\" : \"rightSF\",\n    \"2\" : \"errSF\",\n    \"3\" : \"errSF\",\n\n}\nlet blockWidth = 82\nlet miWidth   = 20\n\nlet speed = 1200\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        starPre : cc.Prefab,\n        starPNode : cc.Node , //当前题目标记星星\n        rightSF     : cc.SpriteFrame,\n        errSF     : cc.SpriteFrame,\n        initSF     : cc.SpriteFrame,\n        blueStar :  cc.Node,\n        flayNode : cc.Node, //飞行管理node\n        rigthAction :cc.Node,\n    },\n\n\n\n    // use this for initialization\n    onLoad: function () {\n        this.starData = []\n        this.starFlagAction()\n    },\n    //题目总数\n    init:function (numCount) {\n        for(let i = 0, starPre; i < numCount; i++){\n            starPre = cc.instantiate(this.starPre);\n            starPre.parent = this.node;  \n            starPre.position = cc.p(-numCount/2*(blockWidth+miWidth)+i*(blockWidth+miWidth)+miWidth/2+blockWidth/2, 710)\n            if (!this.starData) {\n                thi.starData = []\n            }\n            this.starData.push(starPre)\n        }\n        let startPos = this.getStarPosByIndex(0)\n        this.showStarFlag(startPos)\n        \n    },\n    //设置星星状态  index 题号 ，type 1 对 2 错  isMoveFalg 是否移动标记星\n    setStarTypeByIndex :function (index,type) {\n        this.hideStarFlag()\n        type = type.toString()\n        this.scheduleOnce(function(){\n            if (this.starData[index]) {\n                this.starData[index].getComponent(cc.Sprite).spriteFrame = this[showType[type]]\n            }\n            //正确的星星 错误星星出现动画\n            if (type == \"1\") {\n                this.starData[index].opacity = 0\n                this.starData[index].scaleX = 0.4\n                this.starData[index].scaleY = 0.4\n                this.rigthAction.position = this.starData[index].position\n                this.rigthAction.active = true \n                this.rigthAction.getComponent(cc.Animation).play()\n                var callFunc = cc.callFunc(function (target) {\n                    this.rigthAction.active = false \n                }, this);\n                this.starData[index].runAction( cc.sequence(cc.spawn(cc.scaleTo(0.33,1.2), cc.fadeTo(0.33, 255))\n                , cc.scaleTo(0.16,1),callFunc))\n            }else{\n                this.starData[index].opacity = 0\n                this.starData[index].scaleX = 2\n                this.starData[index].scaleY = 2\n                this.starData[index].runAction( cc.sequence(cc.spawn(cc.scaleTo(0.33,0.9), cc.fadeTo(0.33, 255))\n                , cc.scaleTo(0.16,1)))\n            }\n            if (index+1<this.starData.length) {\n                this.scheduleOnce(function(){\n                    let startPos = this.getStarPosByIndex(index+1)\n                    this.showStarFlag(startPos)\n                },0.55);\n            }\n        },0.34);\n \n    },\n    //返回星星的坐标\n    getStarPosByIndex :function (index) {\n        if (this.starData[index]) {\n           return this.starData[index].position \n        }\n    },\n    //显示标记星星\n    showStarFlag:function (pos) {\n        this.starPNode.position = pos \n        this.starPNode.runAction(cc.spawn(cc.scaleTo(0.33,1), cc.rotateTo(0.33, 0)))\n    },\n    //隐藏标记星\n    hideStarFlag:function () {\n        this.starPNode.runAction(cc.spawn(cc.scaleTo(0.33,0), cc.rotateTo(0.33, -90)))\n    },\n    //标记星星 闪光动画\n    starFlagAction:function () {\n        this.starPNode.zIndex = 100\n        let actionNode = this.starPNode.getChildByName(\"starAction\")\n        actionNode.runAction( cc.repeatForever(cc.sequence(cc.spawn(cc.scaleTo(1,1.5), cc.fadeTo(1, 255))\n        , cc.spawn(cc.scaleTo(1,1), cc.fadeTo(1, 200)))))\n        \n    },\n    //设置飞星动画 startPos 星星起始位置  flagIndex 题目题号 callback 附加方法    type 1 是对 2是错 \n    //callback 可不传  object  调用方法的对象\n    playFlayStar:function (startPos,flagIndex,type,callback,object) {\n        this.flayNode.position = startPos\n        this.flayNode.active = true \n        let pos  = this.getStarPosByIndex(flagIndex)\n        var callFunc = cc.callFunc(function (target) {\n            let lizi = this.flayNode.getChildByName(\"particlesystem\").getComponent(cc.ParticleSystem);\n            lizi.resetSystem()\n            this.flayNode.active = false \n            this.setStarTypeByIndex(flagIndex,type) \n            if (callback) {\n                callback.call(object);                \n            }\n        }, this);\n        let distance =  cc.pDistance(pos, startPos);\n        let time = Math.min(distance/speed,1.5)\n        this.flayNode.runAction(cc.sequence(cc.moveTo(time,pos), callFunc))\n        this.blueStar.runAction(cc.rotateTo(time,1440))\n    }\n\n    \n\n    // called every frame, uncomment this function to activate update callback\n    // update: function (dt) {\n\n    // },\n});\n"]}