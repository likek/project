{"version":3,"sources":["../../../../../assets/components/Options/assets/components/Options/OptionJS.js"],"names":["scDuration","cc","Class","extends","Component","properties","parent_node","Node","canMove","exchangeParent","content","onLoad","node","on","EventType","TOUCH_START","touch_start","bind","TOUCH_MOVE","touch_move","TOUCH_END","touch_end","TOUCH_CANCEL","touch_cancel","audioPool","self","document","addEventListener","resetState","parent","onCollisionEnter","other","gameJS","tipsFinished","tipsFormulaNode","nowQuestionID","formulaItemJs","getComponent","isCollisioned","sheepNode","markNode","reloadState","onCollisionStay","onCollisionExit","init","option","optionLength","opacity","startx","x","starty","y","hideContent","getChildByName","active","displayContent","setWhiteColor","resetColor","cloneOption","instantiate","tag","addChild","tipsOptionNode","optionJS","updateState","evt","changeMoveTag","pauseTipsAnimation","playOptionAudio","dragX","dragY","name","nodePosition","convertToWorldSpaceAR","p","dragNode","newPosition","convertToNodeSpaceAR","setPosition","playOptionOutAudio","isTouch","check","optionClick","delta","touch","getDelta","touches","getTouches","parentNode","scaleNode","judgePos","convertTouchToNodeSpaceAR","Math","abs","width","height","CONSOLE_LOG_OPEN","log","zIndex","moveAction","moveTo","calculateAnimTime","runAction","sequence","callFunc","moveOptionTag","destroy","removeFromParent","resumeTipsAnimation","distance","pDistance","position","s","nextTipsAnimation","interactable","resumeSystemEvents","pauseSystemEvents"],"mappings":"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","file":"OptionJS.js","sourceRoot":"../../../../../assets/components/Options","sourcesContent":["var scDuration = 0.2;\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        parent_node: cc.Node,\n        canMove: false,\n        exchangeParent: true,\n        content: \"\",\n    },\n    onLoad: function () {\n        this.node.on(cc.Node.EventType.TOUCH_START, this.touch_start.bind(this), this.node);\n        this.node.on(cc.Node.EventType.TOUCH_MOVE, this.touch_move.bind(this), this.node);\n        this.node.on(cc.Node.EventType.TOUCH_END, this.touch_end.bind(this), this.node);\n        this.node.on(cc.Node.EventType.TOUCH_CANCEL, this.touch_cancel.bind(this), this.node);\n        this.audioPool = [];\n        var self = this;\n        //等同于切后台监听\n        document.addEventListener('resignActivePauseGame', function () {\n            self.resetState();\n        });\n        this.parent_node = this.parent_node.parent;\n    },\n\n    onCollisionEnter: function (other, self) {\n        if(this.gameJS.tipsFinished || this.gameJS.tipsFormulaNode === other.node||this.gameJS.nowQuestionID !== 0){\n            let formulaItemJs  = other.getComponent(\"FormulaItem\");\n            if(formulaItemJs && !formulaItemJs.content){\n                this.node.isCollisioned = true;\n                this.sheepNode = other.node;\n            }else if(formulaItemJs && formulaItemJs.content){\n                formulaItemJs.markNode && formulaItemJs.markNode.getComponent(\"OptionJS\").reloadState();\n                this.node.isCollisioned = true;\n                this.sheepNode = other.node;\n            }\n        }\n    },\n    onCollisionStay(other, self){\n        if(this.gameJS.tipsFinished || this.gameJS.tipsFormulaNode === other.node||this.gameJS.nowQuestionID !== 0){\n            let formulaItemJs  = other.getComponent(\"FormulaItem\");\n            if(formulaItemJs){\n                formulaItemJs.markNode = self.node;\n            }\n        }\n    },\n    onCollisionExit: function (other, self) {\n        if(this.gameJS.tipsFinished || this.gameJS.tipsFormulaNode === other.node||this.gameJS.nowQuestionID !== 0){\n            // if (CONSOLE_LOG_OPEN) console.log('on collision exit');\n            this.node.isCollisioned = false;\n            let formulaItemJs  = other.getComponent(\"FormulaItem\");\n            if(formulaItemJs){\n                formulaItemJs.content = null;\n                formulaItemJs.markNode = null;\n                this.sheepNode = null;\n            }\n        }\n        // this.node.opacity = 255;  \n    },\n\n\n    init: function (gameJS, option, optionLength) {\n        this.node.opacity = 255;\n        this.startx = this.node.x;\n        this.starty = this.node.y;\n        this.gameJS = gameJS;\n        this.option = option; //选项（选项，选项答案）\n        this.hideContent();\n        // this.optionNo = option.optionNo;\n        // this.node.getComponent(cc.Sprite).spriteFrame = this.gameJS.getSpriteFrame(this.option.optioncontimg);\n\n    },\n    hideContent(){\n        this.node.getChildByName(\"bg\").active = false;\n        this.node.getChildByName(\"content\").active = false;\n    },\n    displayContent(){\n        this.node.getChildByName(\"bg\").active = true;\n        this.node.getChildByName(\"content\").active = true;\n    },\n    setWhiteColor(){\n        this.node.getChildByName(\"bg\").opacity = 0;\n    },\n    resetColor(){\n        this.node.getChildByName(\"bg\").opacity = 255;\n    },\n    cloneOption(parent){\n        let option = cc.instantiate(this.node);\n        option.tag = option.tag + 9;\n        parent.addChild(option);\n        if(!this.gameJS.tipsFinished){\n            this.gameJS.tipsOptionNode = option;\n        }\n        let optionJS = option.getComponent(\"OptionJS\");\n        if(optionJS){\n           optionJS.init(this.gameJS, {}, 4);\n           optionJS.parent_node = this.parent_node;\n           optionJS.canMove = true;\n           optionJS.canMove = true;\n           optionJS.content = this.content;\n           optionJS.exchangeParent = this.exchangeParent;\n           optionJS.updateState(true);\n        }\n    },\n    touch_start: function (evt) {\n        this.canMove = this.gameJS.changeMoveTag(this.node.tag);\n        if (!this.canMove) {\n            return;\n        }\n        if(!this.gameJS.tipsFinished){\n            this.gameJS.pauseTipsAnimation();\n        }\n        this.gameJS.playOptionAudio();\n        this.dragX = this.node.x;\n        this.dragY = this.node.y;\n        // this.parent_node.zIndex = 1;\n        this.displayContent();\n        this.setWhiteColor();\n        if(\"option_node\" === this.node.parent.name){\n            this.cloneOption(this.node.parent);\n        }\n        let nodePosition = this.node.convertToWorldSpaceAR(cc.p(0, 0));\n        this.node.parent = this.gameJS.dragNode;\n        let newPosition = this.node.parent.convertToNodeSpaceAR(nodePosition);\n        this.node.setPosition(newPosition);\n    },\n    touch_end: function (evt) {\n        if (!this.canMove) {\n            return;\n        }\n        this.gameJS.playOptionOutAudio();\n        var isTouch = this.check();\n        if (isTouch) {\n            this.optionClick();\n        } else {\n            this.reloadState();\n        }\n    },\n    touch_move: function (evt) {\n        if (!this.canMove) {\n            return;\n        }\n        var delta = evt.touch.getDelta();\n        this.node.x += delta.x;\n        this.node.y += delta.y;\n\n        //出屏还原\n        var touches = evt.getTouches();\n        var parentNode = this.gameJS.scaleNode.parent;\n        var judgePos = parentNode.convertTouchToNodeSpaceAR(touches[0]);\n        if (Math.abs(judgePos.x) < (parentNode.width / 2 - 50) &&\n            Math.abs(judgePos.y) < (parentNode.height / 2 - 30)) {\n            //cc.log(\"触屏校验\" + judgePos.x + \"  \" + judgePos.y);\n        } else {\n            if (CONSOLE_LOG_OPEN) cc.log('出屏了');\n            this.reloadState();\n        }\n    },\n    touch_cancel: function (evt) {\n        if (!this.canMove) {\n            return;\n        }\n        // this.reloadState();\n    },\n\n    check: function () {\n        if (CONSOLE_LOG_OPEN) cc.log('this.node.isCollisioned=' + this.node.isCollisioned);\n        return this.node.isCollisioned;\n    },\n\n    /* 切换后台恢复位置 */\n    resetState: function () {\n        //this.node.getComponent(cc.Button)._pressed = false;\n\n    },\n    reloadState: function () {\n        this.canMove = false; //防止超屏多次触发\n        //父类变换时还原父类使用\n        if (this.exchangeParent) {\n            let nodePosition = this.node.convertToWorldSpaceAR(cc.p(0, 0));\n            let newPosition = this.parent_node.convertToNodeSpaceAR(nodePosition);\n            this.node.setPosition(newPosition);\n            this.node.parent = this.parent_node;\n            this.node.parent.zIndex = 1;\n        }\n        //复位add\n        var moveAction = cc.moveTo(this.calculateAnimTime(), cc.p(this.startx, this.starty));\n        this.node.runAction(cc.sequence(moveAction, cc.callFunc(function () {\n            this.node.setPosition(this.startx, this.starty);\n            this.node.parent.zIndex = 0;\n            this.updateState(true);\n            if(this.gameJS.moveOptionTag === this.node.tag){\n                this.gameJS.changeMoveTag(0);\n                if(!this.gameJS.tipsFinished && this.gameJS.nowQuestionID === 0){\n                    this.gameJS.changeMoveTag(this.gameJS.tipsOptionNode.tag);\n                }\n            }\n            this.hideContent();\n            this.node.destroy();\n            this.node.removeFromParent();\n            if(!this.gameJS.tipsFinished && this.gameJS.nowQuestionID === 0){\n                this.gameJS.resumeTipsAnimation();\n            }\n        }, this)));\n    },\n    //计算复位动画执行时间\n    calculateAnimTime: function () {\n        var distance = cc.pDistance(this.node.position, cc.p(this.startx, this.starty));\n        var s = distance / 1000;\n        s = s > 1 ? 1 : s;\n        return s * 0.2;\n    },\n\n    optionClick: function () {\n        if (this.exchangeParent) {\n            this.node.parent = this.sheepNode;\n            this.node.setPosition(0,0);\n        }\n        this.canMove = false;\n        this.gameJS.changeMoveTag(0);\n        if(!this.gameJS.tipsFinished && this.gameJS.nowQuestionID === 0){\n            this.gameJS.changeMoveTag(this.gameJS.tipsOptionNode.tag);\n            this.gameJS.nextTipsAnimation();\n        }\n        this.sheepNode.getComponent(\"FormulaItem\").content = this.content;\n    },\n    /*node禁止触摸事件 \n     */\n    updateState: function (interactable) {\n        if (interactable) {\n            this.node.resumeSystemEvents(true);\n        } else {\n            this.node.pauseSystemEvents(true);\n        }\n    },\n\n   \n});"]}