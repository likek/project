{"version":3,"sources":["GameJS.js"],"names":["BaseGameJS","require","cc","Class","extends","properties","optionItem_pref","Prefab","settlePrefab","resetBtn","Node","commitBtn","winAudio","AudioClip","loseAudio","resetAudio","optionAudio","option_outAudio","formulaItem","formulaContainer","optionsPrefab","optionsBgNode","questionBg","dragNode","onLoadChild","_super","scaleNode","node","getChildByName","option_node","tipsNode","rightFeedbackNode","active","answerItemPool","NodePool","changeMoveTag","initToast","collisionManager","director","getCollisionManager","enabled","tipsFinished","tipsIndex","tipsCount","efailed","efailedJs","getComponent","game","tipsFinishedCall","removeFromParent","destroy","tipsOptionNode","tipsFormulaNode","initFeedback","settlement","instantiate","settlementJs","feedbackNode","addChild","gotoBackground","array","children","i","length","tempOption","optionJS","canMove","stopAllActions","reloadState","submitButton","resetButton","setScale","_pressed","_hovered","normalSprite","commitBtnNSF","hoverSprite","resetBtnNSF","timeout","deleteOption","createOption","optionsArr","removeAllChildren","options","option","tag","init","updateState","createFormulaItem","formulaStr","spliceReg","formulaItems","match","item","itemNode","itemJS","Label","string","content","replace","BoxCollider","x","width","y","startloadOption","updateGameState","isShowFeed","question","currQuestion","questionArr","nowQuestionID","questionBgNode","qescont","quescontimgAry","checkFormulaStr","formula","CONSOLE_LOG_OPEN","console","warn","isTotalCd","interactiveJson","totalcd","Button","interactable","answerTime","countDown","parseInt","timeLabel","timeFormat","isIts","showSchedule","lastAnswerTime","nextTipsAnimation","pauseTipsAnimation","questionNumListJS","changeOptionEnable","sp","Skeleton","setAnimation","opacity","runAction","sequence","delayTime","fadeIn","time_node","setPosition","position","height","moveBy","title_node","formulaReg","test","selectAnswer","isRight","isShowLossTime","unschedule","timeCallback","log","createAnswerInfo","showFeedback","type","AUDIO_OPEN","playWinAudio","playLoseAudio","formulaAni","itemjs","markNode","resetColor","scheduleOnce","playWinAnim","feedbackFinish","playLoseAnim","playTimeUpAnim","setTimeout","question_node","resumeSystemEvents","pauseSystemEvents","otherClicked","playCancelAudio","resetClicked","cb","isShowAnim","confirmClicked","isEqual","eval","playAudio","playOptionAudio","playOptionOutAudio","audio","audioEngine","play","pauseAllActions","startPos","convertToWorldSpaceAR","p","parent","convertToNodeSpaceAR","resumeTipsAnimation","resumeAllActions","endPos","scaleTo","callFunc","repeatForever","ansower","getAnsower","getOptionNodeByMark","value","getEmptyFormulaNodeByIndex","moveTo","formulaNodes","count","mark","marks","indexOf","lastIndexOf","window","join","index","itemsCopy","firstIdx","secIdx","slice","j"],"mappings":"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","file":"GameJS.js","sourceRoot":"../../../../assets/scripts","sourcesContent":["var BaseGameJS = require(\"BaseGameJS\");\n\ncc.Class({\n    extends: BaseGameJS,\n\n    properties: {\n        optionItem_pref: cc.Prefab, //选项预制\n        settlePrefab: cc.Prefab,\n        resetBtn: cc.Node,\n        commitBtn: cc.Node, //备选\n\n        winAudio: cc.AudioClip,\n        loseAudio: cc.AudioClip,\n        resetAudio: cc.AudioClip,\n        optionAudio: cc.AudioClip,\n        option_outAudio: cc.AudioClip,\n\n        formulaItem: cc.Prefab,\n        formulaContainer: cc.Node,\n        optionsPrefab: cc.Prefab,\n        optionsBgNode: cc.Node,\n        questionBg: cc.Node,\n        dragNode: cc.Node,\n    },\n\n    onLoadChild: function () {\n        this._super();\n        this.scaleNode = this.node.getChildByName('scale');\n        this.option_node = this.scaleNode.getChildByName('option_node');\n        this.tipsNode = this.node.getChildByName('TipsNode');\n        this.rightFeedbackNode = this.scaleNode.getChildByName(\"rightFeedback\");\n        this.tipsNode && (this.tipsNode.active = true);\n        this.answerItemPool = new cc.NodePool();\n        this.changeMoveTag(0);\n        this.initToast();\n        let collisionManager = cc.director.getCollisionManager();\n        collisionManager.enabled = true;\n        this.tipsFinished = false;\n        this.tipsIndex = 0;\n        this.tipsCount = 0;\n        // collisionManager.enabledDebugDraw = true;\n    },\n    //初始化toast框\n    initToast: function () {\n        var efailed = this.node.getChildByName('scale').getChildByName('efailed');\n        this.efailedJs = efailed.getComponent('efailed');\n        this.efailedJs.game = this;\n    },\n\n    tipsFinishedCall: function () {\n        this.tipsNode.removeFromParent(true);\n        this.tipsNode.destroy();\n        this.tipsOptionNode = null;\n        this.tipsFormulaNode = null;\n        this.tipsFinished = true;\n    },\n    initFeedback: function () {\n        this.settlement = cc.instantiate(this.settlePrefab);\n        this.settlementJs = this.settlement.getComponent('settlement');\n        this.settlementJs.game = this;\n        var feedbackNode = this.node.getChildByName('feedback_node');\n        feedbackNode.addChild(this.settlement);\n        this.settlement.active = false;\n    },\n    //转到后台\n    gotoBackground: function () {\n        var array = this.option_node.children[0].children;\n        for (var i = 0; i < array.length; i++) {\n            var tempOption = array[i];\n            var optionJS = tempOption.getComponent('OptionJS');\n            if (optionJS.canMove) {\n                tempOption.stopAllActions();\n                optionJS.reloadState();\n                break;\n            }\n        }\n        let submitButton = this.node.getChildByName('button_node').getChildByName('commit'),\n            resetButton = this.node.getChildByName('button_node').getChildByName('cancel');\n        submitButton.setScale(1, 1);\n        resetButton.setScale(1, 1);\n        submitButton._pressed = false;\n        submitButton._hovered = false;\n        resetButton._pressed = false;\n        resetButton._hovered = false;\n        submitButton.normalSprite = this.commitBtnNSF;\n        submitButton.hoverSprite = this.commitBtnNSF;\n        resetButton.normalSprite = this.resetBtnNSF;\n        resetButton.hoverSprite = this.resetBtnNSF;\n\n    },\n\n    /*超时处理 \n     */\n    timeout: function () {\n\n    },\n\n    //移除当前所有选项\n    deleteOption: function () {\n        // var array = this.option_node.children;\n        // for (var i = 0; i < array.length;) {\n        //     var tempOption = array[i];\n        //     var graph_btn = tempOption.getChildByName('button_bg');\n        //     graph_btn.opacity = 255;\n        //     //放进对象池会自动调用removeFromParent\n        //     this.answerItemPool.put(tempOption);\n        // }\n        // this.option_node.removeAllChildren(true);  \n        //移除question_node内容\n    },\n\n    //创建选项按钮\n    createOption: function (optionsArr) {\n        this.option_node.removeAllChildren();\n        if(optionsArr && optionsArr.length){//如果选项走配置\n            //...\n        }else{\n            this.option_node.addChild(cc.instantiate(this.optionsPrefab));\n            let options = this.option_node.children[0].children;\n            let option,optionJS;\n            for(let i=0;i<options.length;i++){\n               option = options[i];\n               option.tag = 100 + i;\n               optionJS = option.getComponent(\"OptionJS\");\n               if(optionJS){\n                  optionJS.init(this, {}, 4);\n                  optionJS.updateState(true);\n               }\n            }\n        }\n    },\n    createFormulaItem(formulaStr){\n        this.formulaContainer.removeAllChildren();\n        let spliceReg = /\\(\\d+|\\d+\\)|\\d+|\\_|\\+|\\-|\\*|\\/|\\=/g;//用来拆分算式的每一项(空项为下划线)\n        let formulaItems = formulaStr.match(spliceReg);//得到算式的每一项\n        for(let i = 0,item,itemNode,itemJS; i<formulaItems.length; i++){\n            item = formulaItems[i];\n            itemNode = cc.instantiate(this.formulaItem);\n            this.formulaContainer.addChild(itemNode);\n            itemJS = itemNode.getComponent(\"FormulaItem\");\n            if(item === \"_\"){ //空项\n                itemNode.getChildByName(\"bg\").active = true;\n                itemNode.getChildByName(\"content\").getComponent(cc.Label).string = \"\";\n                itemJS.content = null;\n            }else{\n                itemNode.getChildByName(\"bg\").active = false;\n                itemNode.getChildByName(\"content\").getComponent(cc.Label).string = item.replace(\"*\",\"×\").replace(\"/\",\"÷\");\n                itemJS.content = item;\n                itemNode.getComponent(cc.BoxCollider).destroy();\n            }\n            itemNode.x = itemNode.width * i - itemNode.width*formulaItems.length/2 + itemNode.width/2;\n            itemNode.y = 40;\n        }\n    },\n    //开始加载选项\n    startloadOption: function () {\n        this.updateGameState(true);\n        this.isShowFeed = false;\n        var question = this.currQuestion =  this.questionArr[this.nowQuestionID];\n        //启动业务初始化\n        //this.question_node.getChildByName('question_label').getComponent(cc.Label).string = question.qescont;\n        this.questionBgNode = this.scaleNode.getChildByName('questionBg');\n        this.questionBgNode.getChildByName('questionLabel').getComponent(cc.Label).string = question.qescont;\n       // this.questionBgNode.getChildByName('questionPic').getComponent(cc.Sprite).spriteFrame = this.getSpriteFrame(question.quescontimgAry[0]);\n        if(question.quescontimgAry[0] && question.quescontimgAry[0].length>0){\n            this.questionBgNode.getChildByName('questionLabel').active = false;\n            this.questionBgNode.getChildByName('questionPic').active = true;\n        }else{\n            this.questionBgNode.getChildByName('questionPic').active = false;\n            this.questionBgNode.getChildByName('questionLabel').active = true;\n        }\n        //正确答案\n        // this.rightOptionNo = question.rightOptionNo;\n        this.createOption(question.optionsArr);\n        if(this.checkFormulaStr(question.formula)){\n            this.createFormulaItem(question.formula);\n        }else{\n            CONSOLE_LOG_OPEN && console.warn(\"不是等式:\" + this.nowQuestionID);\n        }\n        //倒计时\n        let isTotalCd = this.questionArr[0].interactiveJson.totalcd;\n        if(this.nowQuestionID === 0 && !this.tipsFinished){\n            this.resetBtn.getComponent(cc.Button).interactable = this.tipsFinished;\n            this.commitBtn.getComponent(cc.Button).interactable = this.tipsFinished;\n        }else{\n            this.resetBtn.getComponent(cc.Button).interactable = true;\n            this.commitBtn.getComponent(cc.Button).interactable = true;\n            this.tipsFormulaNode = null;\n        }\n        if (this.nowQuestionID === 0 && isTotalCd || !isTotalCd) {\n            this.answerTime = 0;\n            let countDown = parseInt(question.interactiveJson['countDown']);\n            if (countDown > 0) {\n                this.countDown = countDown;\n            }\n            this.timeLabel.string = this.timeFormat(this.countDown);\n            this.tipsCount = question.formula.match(/\\_/g).length;\n        }\n        if (this.tipsFinished) {\n            !this.isIts && this.showSchedule();\n            isTotalCd && (this.lastAnswerTime = this.answerTime);\n            this.changeMoveTag(0);\n        }else if(this.nowQuestionID===0){\n            this.tipsIndex = 0;\n            this.checkFormulaStr(question.formula) && this.nextTipsAnimation(question.formula);\n        }else{\n            this.pauseTipsAnimation();\n            this.changeMoveTag(0);\n        }\n        this.isIts && this.questionNumListJS.changeOptionEnable();\n\n        //入场龙骨\n        this.optionsBgNode.getComponent(sp.Skeleton).setAnimation(0,\"in\",false);\n        //入场渐显\n        this.questionBg.opacity = 0;\n        this.questionBg.stopAllActions();\n        this.questionBg.runAction(cc.sequence( cc.delayTime(0.6), cc.fadeIn(1) ));\n        this.formulaContainer.opacity = 0;\n        this.formulaContainer.stopAllActions();\n        this.formulaContainer.runAction(cc.sequence( cc.delayTime(0.6), cc.fadeIn(1) ));\n        this.time_node.opacity = 0;\n        this.time_node.stopAllActions();\n        this.time_node.runAction(cc.sequence( cc.delayTime(0.6), cc.fadeIn(1) ));\n        //入场掉落和升起\n        // this.resetBtn.stopAllActions();\n        this.resetBtn.setPosition(this.resetBtn.position.x, this.resetBtn.y - this.resetBtn.height);\n        this.resetBtn.runAction(cc.sequence(cc.delayTime(0),cc.moveBy(0.5,0,this.resetBtn.height)));\n        // this.commitBtn.stopAllActions();\n        this.commitBtn.setPosition(this.commitBtn.position.x, this.commitBtn.y - this.commitBtn.height);\n        this.commitBtn.runAction(cc.sequence(cc.delayTime(0),cc.moveBy(0.5,0,this.commitBtn.height)));\n        // this.title_node.stopAllActions();\n        this.title_node.setPosition(this.title_node.position.x, this.title_node.y + 280);\n        this.title_node.runAction(cc.sequence(cc.delayTime(0),cc.moveBy(0.5,0,-280)));\n    },\n    //校验是否为合法的等式字符串\n    checkFormulaStr(formula){\n        let formulaReg = /^((\\d+|\\(\\d+|\\d+\\))[\\+\\-\\*\\/\\_])*(\\d+|\\(\\d+|\\d+\\))\\=\\d+$/;\n        return formulaReg.test(formula) && (formula.match(/\\(/g) &&formula.match(/\\(/g).length) === (formula.match(/\\)/g) && formula.match(/\\)/g).length);\n    },\n    //选中答案\n    selectAnswer: function (isRight) {\n        //显示状态过程中不接收事件\n        if (this.isShowFeed || this.isShowLossTime) {\n            return;\n        }\n        this.unschedule(this.timeCallback);\n        this.isShowFeed = true;\n        this.updateGameState(false);\n        if (isRight) {\n            if (CONSOLE_LOG_OPEN) console.log('答对了');\n            this.createAnswerInfo('1');\n        } else {\n            if (CONSOLE_LOG_OPEN) console.log('答错了');\n            this.createAnswerInfo('2');\n        }\n        this.showFeedback(isRight ? 1:2);\n    },\n    //反馈\n    showFeedback: function (type) {\n        if (type === 1) {\n            //出发\n            AUDIO_OPEN && this.playWinAudio();\n            this.rightFeedbackNode.getComponent(sp.Skeleton).setAnimation(0,\"right_atmosphere\",false);\n        } else if (type === 2) {\n            //出发\n            AUDIO_OPEN && this.playLoseAudio();\n        } else if (type === 3) { //时间到逻辑\n            //出发\n            AUDIO_OPEN && this.playLoseAudio();\n        }\n        if(type === 1 || type === 2){\n            let formulaAni = type === 1 ? \"right\" : \"error\";\n            let formulaItems = this.formulaContainer.children;\n            let item = null,itemjs;\n            for(let i=0;i<formulaItems.length;i++){\n                item = formulaItems[i];\n                itemjs = item.getComponent(\"FormulaItem\");\n                if(itemjs && itemjs.markNode instanceof cc.Node){\n                    itemjs.markNode.getComponent(\"OptionJS\").resetColor();\n                    itemjs.markNode.getChildByName(\"bg\").getComponent(sp.Skeleton).setAnimation(0,formulaAni,false);\n                }\n            }\n        }\n        this.scheduleOnce(()=>{\n            switch(type){\n                case 1:\n                 this.settlementJs.playWinAnim(this.feedbackFinish);\n                 break;\n                 case 2:\n                 this.settlementJs.playLoseAnim(this.feedbackFinish);\n                 break;\n                 case 3:\n                 this.settlementJs.playTimeUpAnim(this.feedbackFinish);\n                 break;\n            }\n            setTimeout(()=>{\n                this.isShowFeed = false;\n            },1100);\n        },1);\n    },\n    updateGameState: function (interactable) {\n        if (interactable) {\n            this.question_node.resumeSystemEvents(true);\n            this.option_node.resumeSystemEvents(true);\n        } else {\n            this.question_node.pauseSystemEvents(true);\n            this.option_node.pauseSystemEvents(true);\n        }\n    },\n    \n    otherClicked: function () {\n        this.playCancelAudio();\n        if (this.isShowFeed) {\n            return;\n        }\n    },\n    /* 再来一次 */\n    resetClicked: function () {\n        let cb = () => {\n            let array = this.formulaContainer.children;\n            for(let i = 0,item,itemJS;i<array.length;i++){\n                item = array[i];\n                itemJS = item.getComponent(\"FormulaItem\");\n                if(itemJS.markNode instanceof cc.Node){\n                    itemJS.markNode.getComponent(\"OptionJS\").reloadState();\n                }\n            }\n            this.changeMoveTag(0);\n            this.resetBtn.getComponent(cc.Button).interactable = true;\n            this.commitBtn.getComponent(cc.Button).interactable = true;\n            this.updateGameState(true);\n        };\n        // this.playCancelAudio();\n        if (this.isShowFeed || this.isShowAnim) {\n            return;\n        }\n        cb();\n    },\n    /* 确认 */\n    confirmClicked: function () {\n        let cb = () => {\n            let array = this.formulaContainer.children;\n            let isEqual = true;\n            let formulaStr = \"\";\n            for(let i = 0,item,itemJS;i<array.length;i++){\n                item = array[i];\n                itemJS = item.getComponent(\"FormulaItem\");\n                if(!itemJS.content){\n                    return this.selectAnswer(false);\n                }else{\n                    formulaStr += itemJS.content.replace(\"=\",\"===\");\n                }\n            }\n            isEqual = eval(formulaStr);\n            this.selectAnswer(isEqual);\n            if(!this.tipsFinished && this.nowQuestionID === 0){\n                this.tipsFinishedCall();\n            }\n            setTimeout(()=>{\n                this.resetBtn.getComponent(cc.Button).interactable = true;\n                this.commitBtn.getComponent(cc.Button).interactable = false;\n            },0);\n        };\n    //    this.playCancelAudio();\n        //this.isShowAnim\n        if (this.isShowFeed) {\n            return;\n        }\n        cb();\n    },\n    playWinAudio: function () {\n        this.playAudio(this.winAudio);\n    },\n\n    playLoseAudio: function () {\n        this.playAudio(this.loseAudio);\n    },\n    playCancelAudio: function () {\n        this.playAudio(this.resetAudio);\n    },\n    playOptionAudio: function () {\n        this.playAudio(this.optionAudio);\n    },\n    playOptionOutAudio: function () {\n        this.playAudio(this.option_outAudio);\n    },\n\n    //播放音效\n    playAudio: function (audio) {\n        if (AUDIO_OPEN) {\n            cc.audioEngine.play(audio, false, 1);\n        }\n    },\n    pauseTipsAnimation: function(){\n        this.tipsNode.pauseAllActions();\n        let startPos = this.tipsOptionNode.convertToWorldSpaceAR(cc.p(0, 0));\n        startPos = this.tipsNode.parent.convertToNodeSpaceAR(startPos);\n        startPos.x += this.tipsNode.width/3;\n        startPos.y -= this.tipsNode.height/3;\n        this.tipsNode.setPosition(startPos);\n        this.tipsNode.active = false;\n    },\n    resumeTipsAnimation: function(){\n        this.tipsNode.resumeAllActions();\n        this.tipsNode.active = true;\n    },\n    nextTipsAnimation:function(){\n        this.tipsNode.stopAllActions();\n        this.tipsNode.active = true;\n        if(this.tipsIndex === this.tipsCount){//最后一步引导\n            let commitBtn = this.commitBtn;\n            commitBtn.getComponent(cc.Button).interactable = true;\n\n            let endPos = commitBtn.convertToWorldSpaceAR(cc.p(0, 0));\n            endPos = this.tipsNode.parent.convertToNodeSpaceAR(endPos);\n            endPos.x += this.tipsNode.width/3;\n            endPos.y -= this.tipsNode.height/3 - commitBtn.height/2;\n\n            this.tipsNode.setPosition(endPos);\n            this.tipsNode.runAction(cc.sequence(cc.scaleTo(0.6,0.87),cc.scaleTo(0.2,1.2),cc.callFunc(()=>{\n\n            }))).repeatForever();\n            this.changeMoveTag(0);\n            this.changeMoveTag(999);\n        }else{\n            let formula = this.currQuestion.formula;\n            if(!formula.match(/\\_/g)){\n                this.tipsFinishedCall();\n                return;\n            }\n            let ansower = this.getAnsower(formula);\n            if(!ansower){ \n                CONSOLE_LOG_OPEN&&console.warn(\"此等式没有答案\");\n                return\n            };\n            let tipsOptionNode = this.getOptionNodeByMark(ansower[this.tipsIndex].value);\n            let tipsFormulaNode = this.getEmptyFormulaNodeByIndex(this.tipsIndex);\n            this.changeMoveTag(0);\n            this.changeMoveTag(tipsOptionNode.tag);\n            this.tipsOptionNode = tipsOptionNode;\n            this.tipsFormulaNode = tipsFormulaNode;\n    \n            let startPos = tipsOptionNode.convertToWorldSpaceAR(cc.p(0, 0));\n            startPos = this.tipsNode.parent.convertToNodeSpaceAR(startPos);\n            startPos.x += this.tipsNode.width/3;\n            startPos.y -= this.tipsNode.height/3;\n    \n            let endPos = tipsFormulaNode.convertToWorldSpaceAR(cc.p(0, 0));\n            endPos = this.tipsNode.parent.convertToNodeSpaceAR(endPos);\n            endPos.x += this.tipsNode.width/3;\n            endPos.y -= this.tipsNode.height/3;\n    \n            this.tipsNode.setPosition(startPos);\n            this.tipsNode.runAction(cc.sequence(cc.delayTime(0.3),cc.moveTo(1,endPos),cc.callFunc(()=>{\n                this.tipsNode.setPosition(startPos);\n            }))).repeatForever();\n        }\n        this.tipsIndex++;  \n    },\n    //获取某一个空项节点\n    getEmptyFormulaNodeByIndex(tipsIndex){\n        let formulaNodes = this.formulaContainer.children;\n        let count = 0;\n        for(let i = 0;i<formulaNodes.length;i++){\n            if(!formulaNodes[i].getComponent(\"FormulaItem\").content){\n                if(tipsIndex === 0){\n                    return formulaNodes[i];\n                }else{\n                    if(count === tipsIndex){\n                        return formulaNodes[i];\n                    }else{\n                        count++;\n                    }\n                }\n            }\n        }\n    },\n    //获取某一个选项\n    getOptionNodeByMark(mark){\n        let options = this.option_node.children[0].children;\n        for(let i = 0;i<options.length;i++){\n            if(options[i].getComponent(\"OptionJS\").content === mark){\n                return options[i];\n            }\n        }\n    },\n    //获取答案(仅获取一种)\n    getAnsower(formula){ \n        let spliceReg = /\\(\\d+|\\d+\\)|\\d+|\\_|\\+|\\-|\\*|\\/|\\=/g;//用来拆分算式的每一项(空项为下划线)\n        let formulaItems = formula.match(spliceReg);\n        let marks = [\"+\",\"-\",\"*\",\"/\"];\n        if(formulaItems.indexOf(\"_\") === formulaItems.lastIndexOf(\"_\")){ //只有一个空项\n            for(let i = 0;i<marks.length;i++){\n                if(window.eval(formulaItems.join(\"\").replace(\"_\",marks[i]).replace(\"=\",\"===\"))){\n                    return [{\n                        index: formulaItems.indexOf(\"_\"),\n                        value: marks[i]\n                    }]\n                }\n            }\n        }else{ //两个空项\n            let itemsCopy = null,firstIdx,secIdx;\n            firstIdx = formulaItems.indexOf(\"_\");\n            secIdx = formulaItems.lastIndexOf(\"_\");\n            for(let i = 0;i<marks.length;i++){\n                itemsCopy = formulaItems.slice();\n                itemsCopy[firstIdx] = marks[i];//替换第1个下划线\n                for(let j = 0;j<marks.length;j++){\n                    itemsCopy[secIdx] = marks[j];//替换第2个下划线\n                    if(window.eval(itemsCopy.join(\"\").replace(\"=\",\"===\"))){\n                        return [{\n                            index:firstIdx,\n                            value:marks[i]\n                        },{\n                            index: secIdx,\n                            value: marks[j]\n                        }]\n                    }\n                }\n            }\n        }\n    }\n});"]}