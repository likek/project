{"version":3,"sources":["settlement.js"],"names":["DB_ANIM_ASSET","cc","Class","extends","Component","properties","onLoad","background","node","getChildByName","scale","glow","glowDots","title","cutes","playWinAnim","callback","active","that","loader","loadRes","SpriteFrame","err","assets","log","getComponent","Sprite","spriteFrame","playDBAnim","anim","Animation","scheduleOnce","call","game","play","playLoseAnim","playTimeUpAnim","name","children","i","length","dragonBones","ArmatureDisplay","playAnimation","reset","opacity","scaleX","scaleY","dba","animationName","msg","CONSOLE_LOG_OPEN"],"mappings":"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","file":"settlement.js","sourceRoot":"../../../../../assets/components/settlement","sourcesContent":["let DB_ANIM_ASSET = {\n    'win': 'happy',\n    'lose': 'sad'\n};\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        \n    },\n\n    // use this for initialization\n    onLoad: function () {\n        this.background = this.node.getChildByName('background');\n        this.scale = this.node.getChildByName('scale');\n        this.glow = this.scale.getChildByName('glow');\n        this.glowDots = this.scale.getChildByName('glow_dots');\n        this.title = this.scale.getChildByName('title');\n        this.cutes = this.scale.getChildByName('cutes');\n    },\n\n    //播放获胜动画\n    playWinAnim: function(callback){\n        this.node.active = true;\n        var that = this;\n        cc.loader.loadRes('win', cc.SpriteFrame, function(err, assets){\n            if (err) {\n                that.log(err);\n            }else{\n                that.title.getComponent(cc.Sprite).spriteFrame = assets;\n            }\n        });\n        this.playDBAnim(DB_ANIM_ASSET['win']);\n\n        var anim = this.node.getComponent(cc.Animation);\n\n        this.scheduleOnce(function(){\n            callback.call(that.game);\n        }, 1.5);\n\n        anim.play('win');\n        \n    }, \n\n    //播放失败动画\n    playLoseAnim: function(callback){\n        this.node.active = true;\n        var that = this;\n        cc.loader.loadRes('lose', cc.SpriteFrame, function(err, assets){\n            if (err) {\n                that.log(err);\n            }else{\n                that.title.getComponent(cc.Sprite).spriteFrame = assets;\n            }\n        });\n        this.playDBAnim(DB_ANIM_ASSET['lose']);\n\n        var anim = this.node.getComponent(cc.Animation);\n\n        this.scheduleOnce(function(){\n            callback.call(that.game);\n        }, 1.5);\n\n        anim.play('lose');\n    },\n\n    //播放失败动画\n    playTimeUpAnim: function(callback){\n        this.node.active = true;\n        var that = this;\n        cc.loader.loadRes('time_up', cc.SpriteFrame, function(err, assets){\n            if (err) {\n                that.log(err);\n            }else{\n                that.title.getComponent(cc.Sprite).spriteFrame = assets;\n            }\n        });\n        this.playDBAnim(DB_ANIM_ASSET['lose']);\n\n        var anim = this.node.getComponent(cc.Animation);\n\n        this.scheduleOnce(function(){\n            callback.call(that.game);\n        }, 1.5);\n\n        anim.play('lose');\n    },\n    \n    playDBAnim: function(name){\n        var children = this.cutes.children;\n        for(var i = 0 ; i < children.length; i ++){\n            children[i].getChildByName('cute').getComponent(dragonBones.ArmatureDisplay).playAnimation(name, -1);\n        }\n    },\n\n    //重置\n    reset: function(){\n        this.background.opacity = 0;\n        this.background.active= false;\n        this.glow.scaleX = 0;\n        this.glow.scaleY = 0;\n        this.glow.opacity = 255;\n        this.glowDots.active = false;\n        this.title.getComponent(cc.Sprite).spriteFrame = null;\n        var children = this.cutes.children;\n        for(var i = 0, dba; i < children.length; i ++){\n            dba = children[i].getChildByName('cute').getComponent(dragonBones.ArmatureDisplay);\n            dba.animationName = null;\n        }\n        this.node.active = false;\n    },\n\n    log: function(msg){\n        if(CONSOLE_LOG_OPEN)cc.log(msg);\n    },\n\n\n    // called every frame, uncomment this function to activate update callback\n    // update: function (dt) {\n\n    // },\n});\n"]}