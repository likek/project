{"version":3,"sources":["pinyin.js"],"names":["VALIGN","cc","Enum","TOP","MIDDLE","BOTTOM","HALIGN","LEFT","CENTER","RIGHT","Class","extends","Component","properties","calpinyin","Node","calhanzi","calcontainer","hanzi","pinyin","maxwidth","gap","verticalAlign","textAlign","onLoad","plPool","NodePool","hlPool","refresh","setData","hanziarr","splitCString","hanzimap","toLengthMap","hanzigroup","toGroupHanzi","pinyinarr","split","pinyinmap","pinyingroup","toGrouppinyin","createLabels","createLabelsH","hgroup","pgroup","sy","length","height","i","childrenCount","children","tag","put","h","p","forEach","element","index","size","get","instantiate","position","x","getComponent","Label","string","data","opacity","parent","lmap","r","count","c","t","tl","tlh","j","push","grounps","glength","xs","arr","calNode","Array","width","str","charAt"],"mappings":"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","file":"pinyin.js","sourceRoot":"../../../../assets/scripts","sourcesContent":["var VALIGN = cc.Enum({TOP:0,MIDDLE:1,BOTTOM:2});\nvar HALIGN = cc.Enum({LEFT:0,CENTER:1,RIGHT:2});\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        calpinyin: cc.Node,\n        calhanzi: cc.Node,\n        calcontainer: cc.Node,\n        hanzi: '',\n        pinyin: '',\n        maxwidth: 1600,\n        gap: 20,\n        verticalAlign: {\n            'type': VALIGN,\n            'default': VALIGN.MIDDLE\n        },\n        textAlign: {\n            'type': HALIGN,\n            'default': HALIGN.CENTER\n        }\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n        this.plPool = new cc.NodePool();\n        this.hlPool = new cc.NodePool();\n        this.refresh();\n    },\n\n    setData: function(hanzi, pinyin){\n        this.hanzi = hanzi;\n        this.pinyin = pinyin;\n        this.refresh();\n    },\n\n    refresh: function(){        \n        var hanziarr = this.splitCString(this.hanzi);\n        var hanzimap = this.toLengthMap(hanziarr, this.calhanzi);\n        var hanzigroup = this.toGroupHanzi(hanzimap);\n        \n        if(this.pinyin){\n            var pinyinarr = this.pinyin?this.pinyin.split(' '):[];\n            var pinyinmap = this.toLengthMap(pinyinarr, this.calpinyin);\n            var pinyingroup = this.toGrouppinyin(hanzigroup, pinyinmap);\n            this.createLabels(hanzigroup, pinyingroup);\n        }else {\n            this.createLabelsH(hanzigroup);\n        }\n    },\n\n    //创建显示标签\n    createLabels: function(hgroup, pgroup){\n        var sy = 0;\n        if(this.verticalAlign===VALIGN.TOP){\n            sy = 0;\n        }else if(this.verticalAlign===VALIGN.MIDDLE){\n            sy = +(hgroup.length/2*(this.calhanzi.height + this.calpinyin.height));\n        }else if(this.verticalAlign===VALIGN.BOTTOM){\n            sy = +(hgroup.length*(this.calhanzi.height + this.calpinyin.height));\n        }\n        for(var i = 0; i < this.calcontainer.childrenCount; ){\n            if(this.calcontainer.children[0].tag === 0){\n                this.hlPool.put(this.calcontainer.children[0]);\n            }else if(this.calcontainer.children[0].tag === 1){\n                this.plPool.put(this.calcontainer.children[0]);\n            }\n        }\n        for(var i = 0, h, p; i < hgroup.length; i++){\n            hgroup[i].forEach((element, index) => {\n                if(this.hlPool.size()>0){\n                    h = this.hlPool.get();\n                }else{\n                    h = cc.instantiate(this.calhanzi);\n                }\n                h.position = cc.p(element.x, sy-i*(this.calhanzi.height + this.calpinyin.height)-this.calpinyin.height);\n                h.getComponent(cc.Label).string = element.data;\n                h.opacity = 255;\n                h.parent = this.calcontainer;\n                h.tag = 0;\n            });\n            pgroup[i].forEach((element, index) => {\n                if(this.plPool.size()>0){\n                    p = this.plPool.get();\n                }else{\n                    p = cc.instantiate(this.calpinyin);\n                }\n                p.position = cc.p(element.x, sy-i*(this.calhanzi.height + this.calpinyin.height));\n                p.getComponent(cc.Label).string = element.data;\n                p.opacity = 255;\n                p.parent = this.calcontainer;\n                p.tag = 1;\n            });\n        }\n    },\n\n    //创建显示标签\n    createLabelsH: function(hgroup){\n        var sy = 0;\n        if(this.verticalAlign===VALIGN.TOP){\n            sy = 0;\n        }else if(this.verticalAlign===VALIGN.MIDDLE){\n            sy = +(hgroup.length/2*(this.calhanzi.height));\n        }else if(this.verticalAlign===VALIGN.BOTTOM){\n            sy = +(hgroup.length*(this.calhanzi.height));\n        }\n        for(var i = 0; i < this.calcontainer.childrenCount; ){\n            if(this.calcontainer.children[0].tag === 0){\n                this.hlPool.put(this.calcontainer.children[0]);\n            }else if(this.calcontainer.children[0].tag === 1){\n                this.plPool.put(this.calcontainer.children[0]);\n            }\n        }\n        for(var i = 0, h, p; i < hgroup.length; i++){\n            hgroup[i].forEach((element, index) => {\n                if(this.hlPool.size()>0){\n                    h = this.hlPool.get();\n                }else{\n                    h = cc.instantiate(this.calhanzi);\n                }\n                h.position = cc.p(element.x, sy-i*(this.calhanzi.height));\n                h.getComponent(cc.Label).string = element.data;\n                h.opacity = 255;\n                h.parent = this.calcontainer;\n                h.tag = 0;\n            });\n        }\n    },\n\n    //根据汉字分组对拼音进行分组\n    toGrouppinyin: function(hgroup, lmap){\n        var r = [];\n        r.count = lmap.count;\n        for(var i = 0, c = 0, t = [], tl = 0, tlh = 0; i < hgroup.length; i ++){\n            for(var j = 0; j < hgroup[i].length&&c + j < lmap.count; j++){\n                t.push({\n                    'data': lmap[c+j]['data'],\n                    'length': lmap[c+j]['length'],\n                    'x': hgroup[i][j].x\n                });\n            }\n            r.push(t);\n            t = [];\n            tl = 0;\n            tlh = 0;\n            c += j;\n        }\n        return r;\n    },\n\n    //根据最大宽度限制对文字进行分组\n    toGroupHanzi: function(lmap){\n        var grounps = [];\n        grounps.count = lmap.count;\n        for(var i = 0, t = [], tl = 0; i < lmap.count; i ++){\n            if(tl+lmap[i]['length']<this.maxwidth){\n                lmap[i]['x'] = tl + lmap[i]['length']/2;\n                t.push(lmap[i]);\n                tl+=lmap[i]['length'] + this.gap;\n            }else{\n                t.glength = tl;\n                grounps.push(t);\n                t = [];\n                tl = 0;\n                lmap[i]['x'] = tl + lmap[i]['length']/2;\n                t.push(lmap[i]);\n                tl+=lmap[i]['length'] + this.gap;\n            }\n        }\n        if(t){\n            t.glength = tl;\n            grounps.push(t);\n        }\n\n        for(var i = 0, xs; i < grounps.length; i++){\n            if(this.textAlign === HALIGN.CENTER){\n                xs = grounps[i].glength/2;\n            }else if(this.textAlign === HALIGN.LEFT){\n                xs = this.maxwidth/2;\n            }else if(this.textAlign === HALIGN.RIGHT){\n                xs = grounps[i].glength - this.maxwidth/2;\n            }\n            grounps[i].forEach(element => {\n                element.x = element.x - xs;\n            });\n        }\n        return grounps;\n    },\n\n    //转换为长度映射\n    toLengthMap: function(arr, calNode){\n        var r = {};\n        r.count = arr instanceof Array?arr.length: 0;\n        for(var i = 0; arr instanceof Array&&calNode instanceof cc.Node&&i < arr.length; i++){\n            r[i] = {};\n            r[i]['data'] = arr[i];\n            calNode.getComponent(cc.Label).string = arr[i];\n            r[i]['length'] = calNode.width;\n        }\n        return r;\n    },\n\n    //拆分连续的字符串\n    splitCString: function(str){\n        var r = [];\n        for(var i =0; typeof str === 'string'&&i < str.length; i++){\n            r.push(str.charAt(i));\n        }\n        return r;\n    }\n\n    // update (dt) {},\n});\n"]}