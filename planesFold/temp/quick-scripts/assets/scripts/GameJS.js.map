{"version":3,"sources":["GameJS.js"],"names":["BaseGameJS","require","cc","Class","extends","properties","optionItem_pref","Prefab","settlePrefab","resetBtnNSF","SpriteFrame","commitBtnNSF","questionLabel","Node","winAudio","AudioClip","loseAudio","resetAudio","optionAudio","option_outAudio","option_foldAudio","onLoadChild","_super","scaleNode","node","getChildByName","option_node","tipsNode","active","answerItemPool","NodePool","changeMoveTag","initToast","renderer","THREE","WebGLRenderer","alpha","antialias","setClearColor","domElement","style","position","overflow","transform","webkitTransform","setRendererSize","call","box","Box","document","body","appendChild","self","window","addEventListener","scaleRatio","getScaleRatio","height","width","innerWidth","setSize","setPixelRatio","devicePixelRatio","left","top","innerHeight","efailed","efailedJs","getComponent","game","tipsClick","removeFromParent","destroy","isIts","showSchedule","isTotalCd","questionArr","interactiveJson","totalcd","lastAnswerTime","answerTime","opacity","initFeedback","settlement","instantiate","settlementJs","feedbackNode","addChild","gotoBackground","submitButton","resetButton","setScale","_pressed","_hovered","normalSprite","hoverSprite","pause","gotoForeground","start","timeout","clearScene","deleteOption","createOption","optionsArr","i","length","optionItem","size","get","setPosition","p","graph_btn","tag","optionJS","init","updateState","startloadOption","updateGameState","questionNumListJS","changeOptionDisable","question","nowQuestionID","stringArray","qescont","split","setData","rightOptionNo","countDown","parseInt","timeLabel","string","timeFormat","createPlanes","render","activeInHierarchy","changeOptionEnable","isShowFeed","isShowAnim","selectAnswer","isRight","isShowLossTime","unschedule","timeCallback","CONSOLE_LOG_OPEN","console","log","createAnswerInfo","showFeedback","type","AUDIO_OPEN","playWinAudio","playWinAnim","feedbackFinish","playLoseAudio","playLoseAnim","playTimeUpAnim","interactable","question_node","resumeSystemEvents","pauseSystemEvents","otherClicked","playCancelAudio","rightBtnClick","playOptionAudio","foldable","startAnimation","wrongBtnClick","checkIsEmpty","array","children","isEmpty","forEach","obj","idx","state","playAudio","playOptionOutAudio","playFoldAudio","audio","audioEngine","play","callback","setAnimationHandler","animate","bind","data","boxObj","getBoxObject","rotation","y","x","fold","setTimeout","update","planesData","cameraConf","planeSize","planeRotateSpeed","controlsConf","transformConf","scene","Scene","camera","controls","planesGroup","Object3D","resume","eachAnimationHandler","d","planes","rotateSpeed","PerspectiveCamera","frustum","fov","getSize","near","far","set","z","lookAt","Vector3","OrbitControls","plane","createPlane","add","translate","rotate","scale","item","hasOwnProperty","animationHandler","handler","setEachAnimationHandler","eachHandler","planesData1","planesData2","planes2HasDone","hasCall","setAnimateData","animationIndex","axis","rotateDirection","Math","PI","unfold","planes1HasDone","j","requestAnimate","remove","getCamera","getScene","geometry","PlaneGeometry","applyMatrix","Matrix4","makeTranslation","materialConf","side","DoubleSide","bgColor","color","map","CanvasTexture","generateTexture","colors","startX","startY","endX","endY","material","MeshBasicMaterial","Mesh","translateX","translateY","translateZ","ondrawplane","objGroup","Array","isArray","canvas","createElement","context","getContext","rect","gradient","createLinearGradient","addColorStop","fillStyle","fill"],"mappings":"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","file":"GameJS.js","sourceRoot":"../../../../assets/scripts","sourcesContent":["var BaseGameJS = require(\"BaseGameJS\");\n\ncc.Class({\n    extends: BaseGameJS,\n\n    properties: {\n        optionItem_pref: cc.Prefab, //选项预制\n        settlePrefab: cc.Prefab,\n        resetBtnNSF: cc.SpriteFrame,\n        commitBtnNSF: cc.SpriteFrame, //备选\n        questionLabel:cc.Node,\n\n        winAudio: cc.AudioClip,\n        loseAudio: cc.AudioClip,\n        resetAudio: cc.AudioClip,\n        optionAudio: cc.AudioClip,\n        option_outAudio: cc.AudioClip,\n        option_foldAudio: cc.AudioClip,\n    },\n\n    onLoadChild: function () {\n        this._super();\n        this.scaleNode = this.node.getChildByName('scale');\n        this.option_node = this.scaleNode.getChildByName('option_node');\n        this.tipsNode = this.node.getChildByName('TipsNode');\n        this.tipsNode && (this.tipsNode.active = true);\n        this.answerItemPool = new cc.NodePool();\n        this.changeMoveTag(0);\n        this.initToast();\n\n        //初始化threeJS的Randerer\n        this.renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });\n        this.renderer.setClearColor(0xFFFFFF, 0);\n        this.renderer.domElement.style.position = \"absolute\";\n        this.renderer.domElement.style.overflow = \"visible\";\n        this.renderer.domElement.style.transform = \"translateZ(0)\";\n        this.renderer.domElement.style.webkitTransform = \"translateZ(0)\";\n        // this.renderer.domElement.style.borderRadius = \"50%\";\n        setRendererSize.call(this);\n        this.box = new Box(this.renderer);\n        document.body.appendChild(this.renderer.domElement);\n        var self = this;\n        window.addEventListener('resize', function () {\n            setRendererSize.call(self);\n        });\n        function setRendererSize() {\n            var scaleRatio = THREE.getScaleRatio();\n            var height = 460 * scaleRatio,width = window.innerWidth;\n            this.renderer.setSize(width, height);\n            this.renderer.setPixelRatio( window.devicePixelRatio);\n            this.renderer.domElement.style.left = window.innerWidth/2 - width / 2 + \"px\";\n            this.renderer.domElement.style.top = window.innerHeight/2 - height / 2 + \"px\";\n        }\n    },\n    //初始化toast框\n    initToast: function () {\n        var efailed = this.node.getChildByName('scale').getChildByName('efailed');\n        this.efailedJs = efailed.getComponent('efailed');\n        this.efailedJs.game = this;\n    },\n\n    tipsClick: function () {\n        this.tipsNode.removeFromParent();\n        this.tipsNode.destroy();\n\n        !this.isIts && this.showSchedule();\n        let isTotalCd = this.questionArr[0].interactiveJson.totalcd;\n        isTotalCd && (this.lastAnswerTime = this.answerTime);\n\n        this.renderer.domElement.style.opacity = 1;\n    },\n    initFeedback: function () {\n        this.settlement = cc.instantiate(this.settlePrefab);\n        this.settlementJs = this.settlement.getComponent('settlement');\n        this.settlementJs.game = this;\n        var feedbackNode = this.node.getChildByName('feedback_node');\n        feedbackNode.addChild(this.settlement);\n        this.settlement.active = false;\n    },\n    //转到后台\n    gotoBackground: function () {\n        let submitButton = this.node.getChildByName('button_node').getChildByName('commit'),\n            resetButton = this.node.getChildByName('button_node').getChildByName('cancel');\n        submitButton.setScale(1, 1);\n        resetButton.setScale(1, 1);\n        submitButton._pressed = false;\n        submitButton._hovered = false;\n        resetButton._pressed = false;\n        resetButton._hovered = false;\n        submitButton.normalSprite = this.commitBtnNSF;\n        submitButton.hoverSprite = this.commitBtnNSF;\n        resetButton.normalSprite = this.resetBtnNSF;\n        resetButton.hoverSprite = this.resetBtnNSF;\n        this.box.pause();\n    },\n    //转到前台\n    gotoForeground: function(){\n        this.box.start();\n    },\n    /*超时处理 \n     */\n    timeout: function () {\n        this.box.clearScene();\n    },\n\n    //移除当前所有选项\n    deleteOption: function () {\n        \n    },\n\n    //创建选项按钮\n    createOption: function (optionsArr) {\n        for (var i = 0; i < optionsArr.length; ++i) {\n            var optionItem = null;\n\n            if (this.answerItemPool.size() > 0) {\n                optionItem = this.answerItemPool.get();\n            } else {\n                optionItem = cc.instantiate(this.optionItem_pref);\n            }\n            if (i === 0) {\n                //this.option_node.width = optionsArr.length * optionItem.width + (optionsArr.length + 2) * 20;\n            }\n            optionItem.setPosition(cc.p(-(optionsArr.length / 2 - 0.5 - i) * (optionItem.width + 20), 10));\n            var graph_btn = optionItem.getChildByName('button_bg');\n            graph_btn.tag = 1000 + i;\n            var optionJS = graph_btn.getComponent('OptionJS');\n            optionJS.init(this, optionsArr[i], optionsArr.length);\n            optionJS.updateState(true);\n            this.option_node.addChild(optionItem);\n        }\n\n    },\n\n    //开始加载选项\n    startloadOption: function () {\n        this.updateGameState(true);\n        this.isIts && this.questionNumListJS.changeOptionDisable();\n        var question = this.questionArr[this.nowQuestionID];\n        //启动业务初始化\n        // this.question_node.getChildByName('question_label').getComponent(cc.Label).string = question.qescont;\n        // this.questionBgNode = this.scaleNode.getChildByName('questionBg');\n\n        //题目\n        var questionLabel = this.questionLabel.getComponent(\"pinyin\");\n        var stringArray = question.qescont.split('_');\n        questionLabel.setData(stringArray.length>0?stringArray[0]:\"\",stringArray.length>1?stringArray[1]:\"\");\n\n        //正确答案\n        this.rightOptionNo = question.rightOptionNo;\n        //倒计时\n        let isTotalCd = this.questionArr[0].interactiveJson.totalcd;\n        if (this.nowQuestionID === 0 && isTotalCd || !isTotalCd) {\n            this.answerTime = 0;\n            let countDown = parseInt(question.interactiveJson['countDown']);\n            if (countDown > 0) {\n                this.countDown = countDown;\n            }\n            this.timeLabel.string = this.timeFormat(this.countDown);\n        }\n        //纸片\n        this.box.clearScene();\n        this.box.setData(question);\n        this.box.createPlanes();\n        this.box.render();\n        if (this.tipsNode && !this.tipsNode.activeInHierarchy) {\n            !this.isIts && this.showSchedule();\n            isTotalCd && (this.lastAnswerTime = this.answerTime);\n            this.renderer.domElement.style.opacity = 1;\n        }else{\n            this.renderer.domElement.style.opacity = 0.3;\n        }\n        this.isIts && this.questionNumListJS.changeOptionEnable();\n        this.isShowFeed = false;\n        this.changeMoveTag(0);\n        //出现走了选中isShowFeed=yes,reloadState还没走\n        this.isShowAnim = false;\n    },\n\n    //选中答案\n    selectAnswer: function (isRight) {\n        //显示状态过程中不接收事件\n        if (this.isShowFeed || this.isShowLossTime) {\n            return;\n        }\n        this.unschedule(this.timeCallback);\n        this.isShowFeed = true;\n        this.updateGameState(false);\n        if (isRight) {\n            if (CONSOLE_LOG_OPEN) console.log('答对了');\n            this.createAnswerInfo('1');\n            this.showFeedback(1);\n        } else {\n            if (CONSOLE_LOG_OPEN) console.log('答错了');\n            this.createAnswerInfo('2');\n            this.showFeedback(2);\n        }\n    },\n    //反馈\n    showFeedback: function (type) {\n        if (type === 1) {\n            //出发\n            AUDIO_OPEN && this.playWinAudio();\n            this.settlementJs.playWinAnim(this.feedbackFinish);\n        } else if (type === 2) {\n            //出发\n            AUDIO_OPEN && this.playLoseAudio();\n            this.settlementJs.playLoseAnim(this.feedbackFinish);\n        } else if (type === 3) { //时间到逻辑\n\n            //出发\n            AUDIO_OPEN && this.playLoseAudio();\n            this.settlementJs.playTimeUpAnim(this.feedbackFinish);\n        }\n    },\n    updateGameState: function (interactable) {\n        if (interactable) {\n            this.question_node.resumeSystemEvents(true);\n            this.option_node.resumeSystemEvents(true);\n        } else {\n            this.question_node.pauseSystemEvents(true);\n            this.option_node.pauseSystemEvents(true);\n\n        }\n    },\n    otherClicked: function () {\n        this.playCancelAudio();\n        if (this.isShowFeed) {\n            return;\n        }\n    },\n   \n    rightBtnClick:function(){\n        if (this.isShowFeed || this.isShowAnim) {\n            return;\n        }\n        this.isShowAnim = true;\n        this.playOptionAudio();\n        var self = this;\n        var question = this.questionArr[this.nowQuestionID];\n        var foldable = question.foldable;\n        this.startAnimation((box)=>{\n            // setTimeout(()=>{\n            box.clearScene();\n            self.selectAnswer(foldable);\n            // },1000)\n        });\n    },\n    wrongBtnClick:function(){\n        if (this.isShowFeed || this.isShowAnim) {\n            return;\n        }\n        this.isShowAnim = true;\n        this.playOptionAudio();\n        var self = this;\n        var question = this.questionArr[this.nowQuestionID];\n        var foldable = question.foldable;\n        this.startAnimation((box)=>{\n            // setTimeout(()=>{\n            box.clearScene();\n            self.selectAnswer(!foldable);\n            // },1000)\n        });\n    },\n    checkIsEmpty: function () {\n        let array = this.option_node.children;\n        let isEmpty = true;\n        array.forEach((obj, idx) => {\n            let optionJS = obj.getComponent('OptionJS');\n            //正确区不为正确时\n            if (optionJS && optionJS.state > 1) {\n                isEmpty = false;\n            }\n        }, this);\n        return isEmpty;\n    },\n    playWinAudio: function () {\n        this.playAudio(this.winAudio);\n    },\n\n    playLoseAudio: function () {\n        this.playAudio(this.loseAudio);\n    },\n    playCancelAudio: function () {\n        this.playAudio(this.resetAudio);\n    },\n    playOptionAudio: function () {\n        this.playAudio(this.optionAudio);\n    },\n    playOptionOutAudio: function () {\n        this.playAudio(this.option_outAudio);\n    },\n    playFoldAudio:function(){\n        this.playAudio(this.option_foldAudio);\n    },\n    //播放音效\n    playAudio: function (audio) {\n        if (AUDIO_OPEN) {\n            cc.audioEngine.play(audio, false, 1);\n        }\n    },\n    startAnimation:function(callback){\n        this.box.setAnimationHandler(animate.bind(this))\n        function animate(data){\n            var boxObj = this.box.getBoxObject();\n            if(boxObj.rotation.y <= 0.3){\n                boxObj.rotation.y += 0.01;\n                boxObj.rotation.x -= 0.02;\n            }else{\n                this.playFoldAudio();\n                this.box.setAnimationHandler(null);\n                var self = this;\n                this.box.fold(function(){\n                    setTimeout(()=>{\n                        if(typeof callback === \"function\")callback(self.box);\n                    },1000);\n                });\n            }\n            this.box.render();\n        }\n    },\n    update:function(){\n        this.box && this.box.update();\n    }\n});\n\n//////////////ThreeJS折叠盒子演示类/////////////////\nfunction Box(renderer) {\n    var planesData,cameraConf,planeSize,planeRotateSpeed,controlsConf,transformConf;\n    //场景，相机\n    var scene = new THREE.Scene(),camera,controls;\n    var planesGroup = new THREE.Object3D();\n    var resume = true;\n    this.planesData = [];this.eachAnimationHandler = null;\n    this.setData = function(d){\n        planesData = d.planes.data;//六个卡片(正方形)的数据\n        cameraConf = d.camera;\n        planeSize = d.planes.planeSize;//卡片的尺寸\n        planeRotateSpeed = d.planes.rotateSpeed||0.01;\n        controlsConf = d.controls;\n        transformConf = d.transform;\n\n        camera = new THREE.PerspectiveCamera(cameraConf.frustum.fov, renderer.getSize().width / renderer.getSize().height, cameraConf.frustum.near, cameraConf.frustum.far);\n        camera.position.set(cameraConf.position.x, cameraConf.position.y, cameraConf.position.z);\n        camera.lookAt(new THREE.Vector3(cameraConf.lookAt.x, cameraConf.lookAt.y, cameraConf.lookAt.z));\n        controls = new THREE.OrbitControls(camera);//手势控制\n    }\n    this.createPlanes = function () {\n        var plane;\n        for (var i = 0; i < planesData.length; i++) {\n            plane = createPlane(planesData[i]);\n            planesGroup.add(plane);\n        }\n        var translate = transformConf && transformConf.translate,\n            rotate = transformConf && transformConf.rotate,\n            scale = transformConf && transformConf.scale;\n\n        planesGroup.position.set((translate && translate.x)||0,(translate && translate.y)||0,(translate && translate.z)||0);\n        planesGroup.rotation.set((rotate && rotate.x)||0,(rotate && rotate.y)||0,(rotate && rotate.z)||0);\n        planesGroup.scale.set((scale && scale.x)||1,(scale && scale.y)||1,(scale && scale.z)||1);\n        scene.add(planesGroup);\n\n        if (typeof controlsConf === \"object\") {\n            for (var item in controlsConf) {\n                if (controlsConf.hasOwnProperty(item)) {\n                    controls[item] = controlsConf[item];\n                }\n            }\n        }\n        controls[\"enableZoom\"] = false;\n        controls[\"enablePan\"] = false;\n    }\n    this.update = function(){\n        if(resume && controls){\n            controls.update();\n            if (typeof this.animationHandler === \"function\"){\n                this.animationHandler(planesData);\n            }\n            if (typeof this.eachAnimationHandler === \"function\"){\n                var data;\n                for (var i = 0; i < this.planesData.length; i++) {\n                    data = this.planesData[i];\n                    this.eachAnimationHandler(data);\n                }\n            }\n            renderer.render(scene, camera);\n        }\n    }\n    this.setAnimationHandler = function(handler){\n        this.animationHandler = handler;\n    },\n    this.setEachAnimationHandler = function(eachHandler){\n        this.eachAnimationHandler = eachHandler;\n    },\n    this.fold = function (callback) {\n        var self = this;\n        var planesData1 = [], planesData2 = [];\n        var planes2HasDone = false;\n        var hasCall = false;\n        function setAnimateData(planesData) {\n            for (var i = 0; i < planesData.length; i++) {\n                if (planesData[i].type === \"plane\") {\n                    if (!planesData[i].animationIndex || planesData[i].animationIndex === 1) {\n                        planesData1[planesData1.length] = planesData[i];\n                    } else if (planesData[i].animationIndex === 2) {\n                        planesData2[planesData2.length] = planesData[i];\n                    }\n                } else if (planesData[i].type === \"group\") {\n                    if (!planesData[i].animationIndex || planesData[i].animationIndex === 1) {\n                        planesData1[planesData1.length] = planesData[i];\n                    } else if (planesData[i].animationIndex === 2) {\n                        planesData2[planesData2.length] = planesData[i];\n                    }\n                    setAnimateData(planesData[i].planes);\n                }\n            }\n        }\n        setAnimateData(planesData);\n\n        this.planesData = planesData1;\n        this.setEachAnimationHandler(eachAnimationHandler);\n        function eachAnimationHandler(data) {\n            var plane = data.plane;\n            if (data.axis) {\n                if (data.rotateDirection === -1) {//逆时针合起，顺时针展开\n                    if (plane.rotation[data.axis] > -0.5 * Math.PI) {\n                        plane.rotation[data.axis] -= planeRotateSpeed;\n                    } else {\n                        plane.rotation[data.axis] = -0.5 * Math.PI;\n                        if ((data.animationIndex === 1 || !data.animationIndex) && !planes2HasDone) {\n                            planes2HasDone = true;\n                            this.planesData = planesData2;\n                            this.setEachAnimationHandler(eachAnimationHandler);\n                        } else if (data.animationIndex === 2) {\n                            this.setEachAnimationHandler(null);\n                            if (!hasCall) {\n                                hasCall = true;\n                                if (typeof callback === \"function\") callback(self);\n                            }\n                        }\n                    }\n                } else if (data.rotateDirection === 1) { //顺时针合起，逆时针展开\n                    if (plane.rotation[data.axis] < 0.5 * Math.PI) {\n                        plane.rotation[data.axis] += planeRotateSpeed;\n                    } else {\n                        plane.rotation[data.axis] = 0.5 * Math.PI;\n                        if ((data.animationIndex === 1 || !data.animationIndex) && !planes2HasDone) {\n                            planes2HasDone = true;\n                            this.planesData = planesData2;\n                            this.setEachAnimationHandler(eachAnimationHandler);\n                        } else if (data.animationIndex === 2) {\n                            this.setEachAnimationHandler(null);\n                            if (!hasCall) {\n                                hasCall = true;\n                                if (typeof callback === \"function\") callback(self);\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    this.unfold = function (callback) {\n        var self = this;\n        var planesData1 = [], planesData2 = [];\n        var planes1HasDone = false;\n        var hasCall = false;\n        for (var i = 0; i < planesData.length; i++) {\n            if (planesData[i].type === \"plane\") {\n                if (!planesData[i].animationIndex || planesData[i].animationIndex === 1) {\n                    planesData1[planesData1.length] = planesData[i];\n                } else if (planesData[i].animationIndex === 2) {\n                    planesData2[planesData2.length] = planesData[i];\n                }\n            } else if (planesData[i].type === \"group\") {\n                if (!planesData[i].animationIndex || planesData[i].animationIndex === 1) {\n                    planesData2[planesData2.length] = planesData[i];\n                } else if (planesData[i].animationIndex === 2) {\n                    planesData1[planesData1.length] = planesData[i];\n                }\n                var planes = planesData[i].planes || [];\n                for (var j = 0; j < planes.length; j++) {\n                    if (!planes[j].animationIndex || planes[j].animationIndex === 1) {\n                        planesData1[planesData1.length] = planes[j];\n                    } else if (planes[j].animationIndex === 2) {\n                        planesData2[planesData2.length] = planes[j];\n                    }\n                }\n            }\n        }\n        this.planesData = planesData2;\n        this.setEachAnimationHandler(eachAnimationHandler);\n        function eachAnimationHandler(data, requestAnimate) {\n            var plane = data.plane;\n            if (data.axis) {\n                if (data.rotateDirection === -1) {//逆时针合起，顺时针展开\n                    if (plane.rotation[data.axis] < 0) {\n                        plane.rotation[data.axis] += planeRotateSpeed;\n                    } else {\n                        plane.rotation[data.axis] = 0;\n                        if (data.animationIndex === 1 || !data.animationIndex) {\n                            this.setEachAnimationHandler(null);\n                            if (!hasCall) {\n                                hasCall = true;\n                                if (typeof callback === \"function\") callback(self);\n                            }\n                        } else if (data.animationIndex === 2 && !planes1HasDone) {\n                            planes1HasDone = true;\n                            this.planesData = planesData1;\n                            this.setEachAnimationHandler(eachAnimationHandler);\n                        }\n                    }\n                } else if (data.rotateDirection === 1) { //顺时针合起，逆时针展开\n                    if (plane.rotation[data.axis] > 0) {\n                        plane.rotation[data.axis] -= planeRotateSpeed;\n                    } else {\n                        plane.rotation[data.axis] = 0;\n                        if (data.animationIndex === 1 || !data.animationIndex) {\n                            this.setEachAnimationHandler(null);\n                            if (!hasCall) {\n                                hasCall = true;\n                                if (typeof callback === \"function\") callback(self);\n                            }\n                        } else if (data.animationIndex === 2 && !planes1HasDone) {\n                            planes1HasDone = true;\n                            this.planesData = planesData1;\n                            this.setEachAnimationHandler(eachAnimationHandler);\n                        }\n                    }\n                }\n            }\n        }\n\n\n    }\n    this.render = function () {\n        renderer.render(scene, camera);\n    }\n    //清除场景中所有内容\n    this.clearScene = function () {\n        while(planesGroup.children.length > 0){\n            planesGroup.remove(planesGroup.children[0]);\n        }\n        while (scene.children.length > 0) {\n            scene.remove(scene.children[0]);\n        }\n    }\n    this.getBoxObject = function () {\n        return planesGroup;\n    }\n    this.getCamera = function () {\n        return camera;\n    }\n    this.getScene = function () {\n        return scene;\n    }\n    this.pause = function(){\n        resume = false;\n    }\n    this.start = function(){\n        resume = true;\n    }\n    //创建一个卡片或一个组\n    function createPlane(data) {\n        if (data.type === \"plane\") {\n            var geometry = new THREE.PlaneGeometry(planeSize, planeSize);\n            geometry.applyMatrix(new THREE.Matrix4().makeTranslation(data.translate.x, data.translate.y, data.translate.z));//移动物体\n            var materialConf = {\n                side:THREE.DoubleSide,\n            };\n            if(typeof data.bgColor === \"number\"){\n                materialConf.color = data.bgColor;\n            }else if(typeof data.bgColor === \"object\"){\n                materialConf.map = new THREE.CanvasTexture(generateTexture(data.bgColor.colors,data.bgColor.startX,data.bgColor.startY,data.bgColor.endX,data.bgColor.endY));\n            }\n            var material = new THREE.MeshBasicMaterial(materialConf);\n            var plane = new THREE.Mesh(geometry, material);\n            plane.translateX(data.position.x);//移动坐标\n            plane.translateY(data.position.y);\n            plane.translateZ(data.position.z);\n            scene.add(plane);\n            data.plane = plane;\n            if (typeof data.ondrawplane === 'function') data.ondrawplane(plane);\n            return plane;\n        } else if (data.type === \"group\") {\n            var planes = data.planes;\n            var objGroup = new THREE.Object3D();\n            objGroup.applyMatrix(new THREE.Matrix4().makeTranslation(data.translate.x, data.translate.y, data.translate.z));\n            objGroup.translateX(data.position.x);\n            objGroup.translateY(data.position.y);\n            objGroup.translateZ(data.position.z);\n            data.plane = objGroup;\n            if (typeof data.ondrawplane === 'function') data.ondrawplane(objGroup);\n            if (Array.isArray(planes)) {\n                for (var i = 0; i < planes.length; i++) {\n                    var plane = createPlane(planes[i]);\n                    objGroup.add(plane);\n                    planes[i].plane = plane;\n                    if (typeof data.ondrawplane === 'function') data.ondrawplane(plane);\n                }\n            }\n            return objGroup;\n        }\n    }\n    //自定义canvas渐变色Texture\n    function generateTexture(colors,startX,startY,endX,endY){\n        var size = 64;\n        var canvas = document.createElement( 'canvas' );\n        canvas.width = size;\n        canvas.height = size;\n        var context = canvas.getContext( '2d' );\n        context.rect( 0, 0, size, size );\n        var gradient = context.createLinearGradient( startX*size, startY*size, endX*size, endY*size);\n        for(var i=0;i<colors.length;i++){\n            gradient.addColorStop(i/(colors.length - 1), colors[i]);\n        }\n        context.fillStyle = gradient;\n        context.fill();\n        return canvas;\n    }\n}"]}