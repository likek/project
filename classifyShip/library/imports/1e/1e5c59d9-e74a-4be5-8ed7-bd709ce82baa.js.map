{"version":3,"sources":["../../../../assets/scripts/assets/scripts/Thing.js"],"names":["cc","Class","extends","Component","properties","moveAble","onLoad","node","on","Node","EventType","TOUCH_START","thingTouchStart","bind","TOUCH_MOVE","moveThingTouchMove","TOUCH_END","moveThingTouchEnd","TOUCH_CANCEL","moveThingTouchCanCel","startx","x","starty","y","start","onCollisionEnter","other","self","CONSOLE_LOG_OPEN","console","log","tag","isCollisioned","iswrong","othercollider","onCollisionExit","removeThingByContainerTag","beltLeft","gameJS","beltContainer","getChildByName","beltRight","leftThing","getChildByTag","rightThing","removeFromParent","event","tipsNode","parent","tipsSource","tipsHand","opacity","moveThing","pauseAllActions","touchStart","call","BasicAni","getMoveAble","__optionID","AUDIO_OPEN","playOptionAudio","touchPos","convertToWorldSpaceAR","p","beltNode","convertToNodeSpaceAR","zIndex","delta","touch","getDelta","touches","getTouches","parentNode","scaleNode","judgePos","convertTouchToNodeSpaceAR","Math","abs","width","height","resetPosition","isTouch","check","updateState","playWinAudio","optionClick","playLoseAudio","runAnimation","_t","rightAnimation","stopTipsAnimation","originParent","hasSameTypeThing","playCarMoveAudio","getComponent","setAnimation","active","progressJS","progress","isWin","nowQuestionID","playFlyStarAudio","playFlayStar","getPosition","setTimeout","selectAnswer","currTouchOption","optionID","currPos","v2","setPosition","move","moveTo","calculateAnimTime","moveDown","moveBy","moveUp","stopAllActions","runAction","sequence","callFunc","tipsHandAnimation","resumeAllActions","containers","children","thing","i","length","monkey","giraffe","frog","distance","pDistance","position","s","interactable","resumeSystemEvents","pauseSystemEvents","callback","otherPos","offsetX","offsetY","jump","jumpDown"],"mappings":"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","file":"Thing.js","sourceRoot":"../../../../assets/scripts","sourcesContent":["cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        // gameJS:null,\n        moveAble:false,\n    },\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n        this.node.on(cc.Node.EventType.TOUCH_START, this.thingTouchStart.bind(this), this);\n        this.node.on(cc.Node.EventType.TOUCH_MOVE, this.moveThingTouchMove.bind(this), this);\n        this.node.on(cc.Node.EventType.TOUCH_END, this.moveThingTouchEnd.bind(this), this);\n        this.node.on(cc.Node.EventType.TOUCH_CANCEL, this.moveThingTouchCanCel.bind(this), this);\n        this.startx = this.node.x;\n        this.starty = this.node.y;\n\n    },\n    start () {\n\n    },\n    onCollisionEnter:function(other,self){\n        if (CONSOLE_LOG_OPEN) console.log('on collision enter');\n        if(other.node.tag === self.node.tag){ //答对了\n            this.node.isCollisioned = true;\n            this.node.iswrong = false;\n            this.othercollider = other;\n        }else{\n            this.node.isCollisioned = false;\n            this.node.iswrong = true;//碰进并答错了维持到松手后的状态\n        }\n    },     \n    onCollisionExit: function (other, self) {\n        if (CONSOLE_LOG_OPEN) console.log('on collision exit');\n        this.node.isCollisioned = false;\n        this.node.iswrong = false;\n    },\n\n    removeThingByContainerTag:function(tag){\n        var beltLeft = this.gameJS.beltContainer.getChildByName(\"beltLeft\");\n        var beltRight = this.gameJS.beltContainer.getChildByName(\"beltRight\");\n        var leftThing = beltLeft.getChildByTag(tag).getChildByName(\"thing\");\n        var rightThing = beltRight.getChildByTag(tag).getChildByName(\"thing\");\n        if(leftThing)leftThing.removeFromParent();\n        if(rightThing)rightThing.removeFromParent();    \n    },\n    thingTouchStart:function(event){\n        if(this.gameJS.tipsNode && this.node.parent === this.gameJS.tipsSource){\n            this.gameJS.tipsHand.opacity = 0;\n            this.gameJS.moveThing.opacity = 0;\n            this.gameJS.tipsHand.pauseAllActions();\n            this.gameJS.moveThing.pauseAllActions();\n            this.node.opacity = 255;\n            touchStart.call(this);\n        }else if(!this.gameJS.tipsNode){\n            touchStart.call(this);\n        }\n        function touchStart(){\n            this.gameJS.BasicAni();//重新计时\n            this.moveAble = this.getMoveAble(this.node.__optionID);\n            if(!this.moveAble)return;\n    \n            AUDIO_OPEN && this.gameJS.playOptionAudio();\n            var touchPos = this.node.convertToWorldSpaceAR(cc.p(0,0));\n            touchPos = this.gameJS.beltNode.convertToNodeSpaceAR(touchPos);\n    \n            this.node.parent = this.gameJS.beltNode;\n            this.node.x = touchPos.x;\n            this.node.y = touchPos.y//0;\n            this.node.parent.zIndex = 1;\n        }\n    },\n    moveThingTouchMove:function(event){\n        if(!this.moveAble)return;\n        var delta = event.touch.getDelta();\n        this.node.x += delta.x;\n        this.node.y += delta.y;\n        //出屏还原\n        var touches = event.getTouches();\n        var parentNode = this.gameJS.scaleNode;\n        var judgePos = parentNode.convertTouchToNodeSpaceAR(touches[0]);\n        if (Math.abs(judgePos.x) < (parentNode.width / 2 - 50) &&\n            Math.abs(judgePos.y) < (parentNode.height / 2 - 20)) {\n        } else {\n            if (CONSOLE_LOG_OPEN) cc.log('出屏了');\n            this.resetPosition();\n        }\n    },\n    moveThingTouchEnd:function(event){\n        if(!this.moveAble)return;\n        var isTouch = this.check();\n        this.updateState(false);\n        if (isTouch) {\n            AUDIO_OPEN && this.gameJS.playWinAudio();\n            this.optionClick();\n        }else if(!isTouch && this.node.iswrong){\n            AUDIO_OPEN && this.gameJS.playLoseAudio();\n            this.resetPosition(); \n            this.gameJS.runAnimation.call(this.gameJS,\"error\");\n        } \n        else {\n            this.resetPosition(); \n        }\n    },\n    check: function () {\n        if (CONSOLE_LOG_OPEN) cc.log('this.node.isCollisioned=' + this.node.isCollisioned);\n        return this.node.isCollisioned;\n    },\n    //碰上\n    optionClick:function(){\n        var _t = this;\n        this.rightAnimation(this.othercollider,_t,()=>{\n            if(this.gameJS.tipsNode){\n                this.gameJS.stopTipsAnimation.call(this.gameJS);\n            }\n            this.updateState(true);\n            _t.node.removeFromParent();\n            this.removeThingByContainerTag(this.node.originParent.tag);\n            this.gameJS.runAnimation.call(this.gameJS,\"right\",1400);\n            if(!this.hasSameTypeThing(_t.node.tag)){\n                AUDIO_OPEN && this.gameJS.playCarMoveAudio();\n                this.othercollider.node.parent.getComponent(\"sp.Skeleton\").setAnimation(0,\"settle_accounts\",false);//出场\n                this.othercollider.node.tag = -1;\n                this.othercollider.node.active = false;\n                var progressJS = this.gameJS.progress.getComponent(\"ProgressJs\");\n                if(_t.isWin()){\n                    console.log(\"第\"+(this.gameJS.nowQuestionID+1) + \"题答对了\");\n                    AUDIO_OPEN && _t.gameJS.playFlyStarAudio();\n                    progressJS.playFlayStar(this.othercollider.node.getPosition(),_t.gameJS.nowQuestionID,1) //飞星方法\n                    setTimeout(()=>{\n                        _t.gameJS.selectAnswer(true);\n                    },6000);\n                }\n            }\n            this.moveAble = false;\n            this.gameJS.currTouchOption = null;\n        });\n    },\n    moveThingTouchCanCel:function(event){\n        if(!this.moveAble)return;\n        this.resetPosition();\n    },\n\n    getMoveAble:function(optionID){\n        if(!this.gameJS.currTouchOption || optionID === this.gameJS.currTouchOption){\n            this.gameJS.currTouchOption = optionID;\n            return true;\n        }else{\n            return false;\n        }\n    },\n    // update (dt) {},\n    resetPosition:function(){\n        this.moveAble = false;\n        cc.log(this.node.__optionID+'reset');\n        // var originPos = this.node.originParent.convertToWorldSpaceAR(cc.v2(0,0));\n        // originPos = this.gameJS.scaleNode.convertToNodeSpaceAR(originPos);\n        var currPos = this.node.convertToWorldSpaceAR(cc.v2(0,0));\n        currPos = this.node.originParent.convertToNodeSpaceAR(currPos);\n        // var offsetX = originPos.x - currPos.x,offsetY = originPos.y - currPos.y;\n\n        this.node.parent = this.node.originParent;\n        this.node.setPosition(currPos);\n\n        //var move = cc.moveBy(this.calculateAnimTime(),offsetX,offsetY);\n        var move = cc.moveTo(this.calculateAnimTime(), cc.p(this.startx, this.starty));\n\n        var moveDown = cc.moveBy(0.4,0,-46);//.easing(cc.easeCubicActionOut());\n        var moveUp = cc.moveBy(0.5,0,46);//.easing(cc.easeCubicActionIn());\n            this.node.stopAllActions();\n            this.node.runAction(cc.sequence(\n            move,\n            cc.callFunc(()=>{\n                // this.node.parent = this.node.originParent;\n                // this.node.x = this.node.y = 0;\n               this.gameJS.beltNode.zIndex = 0;\n                this.node.parent.getChildByName('leaf').getComponent(\"sp.Skeleton\").setAnimation(0,\"error\",false);\n            },this),\n            moveDown,\n            moveUp,\n            cc.callFunc(()=>{\n                this.gameJS.currTouchOption = null;\n                this.node.setPosition(this.startx, this.starty);\n                this.updateState(true);\n                if(this.gameJS.tipsNode && this.node.parent === this.gameJS.tipsSource){//引导未结束\n                    this.gameJS.tipsHandAnimation.call(this.gameJS,1);\n                    this.gameJS.tipsHand.resumeAllActions();\n                    this.gameJS.moveThing.resumeAllActions();\n                }\n                //zindex\n                // if(typeof callback === \"function\")callback();\n        })),this);\n    },\n    hasSameTypeThing:function(tag){\n        var containers = this.gameJS.beltContainer.children[0].children;\n        var thing = null;\n        for(let i=0;i<containers.length;i++){\n            thing = containers[i].getChildByName('thing');\n            if(thing && thing.tag === tag){\n                return true;\n            }\n        }\n        return false;\n    },\n    isWin:function(){\n        var monkey = this.gameJS.monkey,giraffe = this.gameJS.giraffe,frog = this.gameJS.frog;\n        return monkey.getChildByName(\"collisionNode\").tag === -1 && giraffe.getChildByName(\"collisionNode\").tag === -1 && frog.getChildByName(\"collisionNode\").tag === -1;\n    },\n        //计算复位动画执行时间\n    calculateAnimTime: function () {\n        var distance = cc.pDistance(this.node.position, cc.p(this.node.originParent.x, this.node.originParent.y));\n        var s = distance / 1000;\n        s = s > 1 ? 1 : s;\n        return s * 0.4;\n    },\n     /*node禁止触摸事件 \n     */\n    updateState: function (interactable) {\n        if (interactable) {\n            this.gameJS.beltContainer.resumeSystemEvents(true);\n            this.gameJS.beltNode.resumeSystemEvents(true);\n        } else {\n            this.gameJS.beltContainer.pauseSystemEvents(true);\n            this.gameJS.beltNode.pauseSystemEvents(true);\n        }\n    },\n    // 碰对动画\n    rightAnimation:function(other,self,callback){ //\n        var otherPos = other.node.convertToWorldSpaceAR(cc.v2(0,0));\n        otherPos = this.gameJS.scaleNode.convertToNodeSpaceAR(otherPos);\n        var currPos = this.node.convertToWorldSpaceAR(cc.v2(0,0));\n        currPos = this.gameJS.scaleNode.convertToNodeSpaceAR(currPos);\n        var offsetX = otherPos.x - currPos.x,offsetY = otherPos.y - currPos.y;\n\n        var jump = cc.moveBy(0.3,offsetX,offsetY+300,600,1);\n        var jumpDown = cc.moveBy(0.3,0,-300,400,1);\n        self.node.runAction(cc.sequence(jump,cc.callFunc(()=>{\n            self.node.parent.zIndex = -1;\n        }),\n        jumpDown,\n        cc.callFunc(()=>{\n            self.node.parent.zIndex = 0;\n            if(typeof callback === 'function')callback();\n        })),this);\n    }\n});\n"]}